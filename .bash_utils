# #
# Search recursively for pattern in python files located in rebase/.
# $ py register_route
#
py () {
	grep -rn --exclude *.pyc --exclude *.swp --color=auto $1 rebase
}


export REBASE_HOST=http://localhost:5000
export REBASE_COOKIE_JAR=/tmp/rebase-cookie-jar.txt

#
# POST to rebase
# e.g.:
# rebase-post "{\"first_name\": \"$1\", \"last_name\":\"$2\", \"email\":\"$3\", \"password\":\"$4\"}" users
#
rebase-post () {
	curl \
	-L \
	-b $REBASE_COOKIE_JAR \
	-c $REBASE_COOKIE_JAR \
	-H "Content-Type: application/json" \
	-X POST -d "$1" \
	$REBASE_HOST/$2
}

#
# Create user in Rebase
# $ rebase-new-user Joe Blow joe@blow.org foobar
#
rebase-new-user () {
	rebase-post \
	"{\"first_name\": \"$1\", \"last_name\":\"$2\", \"email\":\"$3\", \"password\":\"$4\"}" \
	users
}

#
# Login to Rebase
# $ rebase-login you@mail.com password
# 
rebase-login () {
	rebase-post \
	"{ \"user\": {\"email\": \"$1\"}, \"password\": \"$2\"}" \
	auth
}

#
## GET something from Rebase
# $ rebase-get /skill_set
#
rebase-get () {
	curl \
	-L \
	-b $REBASE_COOKIE_JAR \
	-c $REBASE_COOKIE_JAR \
	-H "Content-Type: application/json" \
	-X GET $REBASE_HOST/$1
}
